package lol.nebula.module.exploit;

import lol.nebula.listener.bus.Listener;
import lol.nebula.listener.events.net.EventPacket;
import lol.nebula.module.Module;
import lol.nebula.module.ModuleCategory;
import net.minecraft.network.play.server.S29PacketSoundEffect;

import static java.lang.String.format;

/**
 * @author aesthetical
 * @since 04/29/23
 */
public class ThunderLocator extends Module {

    /**
     * The thunder sound id
     */
    private static final String THUNDER_SOUND_ID = "ambient.weather.thunder";

    public ThunderLocator() {
        super("Thunder Locator", "Locates where thunder has struck on the server", ModuleCategory.EXPLOIT);
    }

    @Listener
    public void onPacketInbound(EventPacket.Inbound event) {
        if (event.getPacket() instanceof S29PacketSoundEffect) {
            S29PacketSoundEffect packet = event.getPacket();
            if (packet.getSoundName().equals(THUNDER_SOUND_ID)) {
                print(format("Thunder sounded at XYZ: %.1f, %.1f, %.1f", packet.getX(), packet.getY(), packet.getZ()));
            }
        }
    }
}
